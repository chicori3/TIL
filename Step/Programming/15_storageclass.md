# 스토리지 클래스

## 1. 기억부류(스토리지 클래스)

변수나 함수를 선언할 때 사용되는 키워드     

1. 변수나 함수의 **저장 위치와 사용 범위**를 결정
2. 변수나 함수 선언 시 **맨 앞에 지정**
3. 변수의 디폴트 기억 부류는 `auto`이고, 함수의 디폴트 기억 부류는 `extern`

## 2. auto 변수

1. **지역 변수**는 디폴트로 `auto` 기억 부류를 사용
2. `auto` 지역 변수는 선언된 위치에서 자동 생성, 선언된 블록을 빠져나갈 때 자동 해제
3. 전역 변수에는 `auto` **지정 불가**
4. for 루프에서 선언 시 루프 내에서만 통용

```c++
int main(void)
{
    auto int x = 10;    // auto 변수 선언
    int y = 20;         // auto를 생략해도 y는 auto 변수임
}
```

## 3. register 변수

1. 변수를 메모리에 할당하는 대신 **CPU의 레지스터에 할당**
2. 변수를 레지스터에 할당하면 변수에 좀 더 빠르게 접근
3. 보통 루프 제어 변수를 레지스터 변수로 선언
4. `register` 변수로 선언해도 변수가 레지스터에 할당되지 않을 수 있음
5. 레지스터 변수에 대해서는 주소 구하기 연산자를 사용할 수 없음

```c++
register int i ;                    // 레지스터 변수를 선언함
for ( i = 0 ; i < 10000 ; i ++ )
    sum + = i ;

printf( “%p”, &i );                 // 레지스터 변수의 주소는 구할 수 없으므로 에러
```

## 4. global 변수

1. 다른 곳에 선언된 변수에 대하여 별도의 메모리 할당없이 해당 변수 사용
2. 전역 변수를 코드 중간에 선언하면, 전역 변수가 선언된 뒤쪽에 정의된 함수에서만 전역 변수를 사용 가능

```c++
void TestGlobal(void)
{
    global = 10;        // 컴파일 에러
}
int global = 0;         // 전역변수 선언
int main(void)
{
    global = 20;        // 전역변수 선언한 이후 사용 가능
}
```
>> 전방 선언 : 전역 변수에 대한 `extern` 선언이 있으면 선언된 위치와 관계없이 전역변수 사용 가능

```c++
extern int global;
void TestGlobal(void)
{
    global = 10;        // 전역변수 사용 가능
}
int global = 0
int main(void)
{
    global = 20;        // 전역변수 사용 가능
}

```

## 5. 정적 지역변수

1. 번역 과정의 마지막 단계인 적재 시간에 기억 장소를 할당받는 변수
2. 전체 프로그램의 종료까지를 생존 기간으로 하며 동일 기억 장소를 유지
3. 초기화는 기억 공간 할당 시 한 번만 초기화
4. 정적 지역변수는 전역변수처럼 프로그램이 시작할 때 메모리에 할당, 종료할 때 해제
5. 전역변수와는 달리 정적 지역변수는 선언된 함수 안에서만 사용
6. 정적 지역변수는 함수가 리턴하더라도 해제되지 않고 남아있음

```c++
#include <stdio.h >

void func() {
    static int x = 0; 
    int y=0;
    x++;
    y++;
    printf("%d %d\n", x, y);
}
int main() { 
    func(); 
    func(); 
    func(); 
    return 0;
}

char* Reverse(const char *str)      // char* 주소를 리턴하는 함수
{
    static char result[80];         // result 배열을 정적 지역변수로 선언
    int i;
    int len = strlen(str);

for( i = 0 ; i < len ; i ++ )
    result[i] = str[len – i – 1];
result[i] = ‘＼0’;
return result;                      // 정적 지역변수의 주소 리턴 
}
```

## 6. 정적 전역변수

1. 정적 전역변수는 정적 전역변수가 선언된 소스 파일에서만 사용
2. 전역변수를 다른 소스 파일에서 접근하지 못하도록 제한

```c++
// Test1.c
int global1;            // 전역변수 선언
static int global2;     // 전역변수 선언
int main(void)
{
    global1 = 10;       // 전역변수 사용 가능
    global2 = 20;       // Test1.c에서만 사용 가능
}

// Test2.c
extern int global1;     // 전역 변수의 extern 선언
extern int global2;     // extern을 선언해도 사용 불가
void f(void)
{
    global1 = 30;       // 전역변수 사용 가능
    global2 = 40;       // 사용 불가
}
```

## 7. 스토리지 클래스 비교

|구분|일반 지역변수|정적 지역변수|전역 변수|정적 전역변수
|:-:|:-:|:-:|:-:|:-:
|선언 위치|함수 안|함수 안|함수 밖|함수 밖
|생성 시점|변수 선언 시|프로그램 시작 시|프로그램 시작 시|프로그램 시작 시
|해제 시점|함수 리턴 시|프로그램 종료 시|프로그램 종료 시|프로그램 종료 시
|사용 범위|함수 안|함수 안|프로그램 전체|선언된 소스 파일
|초기화하지 않았을 때|쓰레기 값|0으로 초기화|0으로 초기화|0으로 초기화