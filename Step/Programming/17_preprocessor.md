# 전처리기

컴파일러가 소스 파일을 **컴파일하기 전에 먼저 수행**되는 프로그램

1. 프로그래머가 작성한 소스 파일이 컴파일될 수 있도록 준비함
2. 전처리기 문장은 `#`으로 시작

## 1. 전처리기 문장

|전처리기 문장|기능
|:--:|:--
|#define|매크로 정의
|#include|헤더 파일 포함
|#if, #else, #endif|조건에 따라 컴파일
|#ifdef|매크로가 정의된 경우 컴파일
|#ifndef|매크로가 정의되지 않은 경우 컴파일

## 2. 매크로 상수

소스 파일에서 매크로 상수가 사용된 곳을 모두 찾아서 정의된 문자열로 대치

```c++
#define MAX 100         // 매크로 상수 MAX를 정의함
average = sum / MAX;    // average = sum / 100으로 처리됨
```

```c++
#define Pi 3.1415               // 실수형 상수를 매크로 상수로 정의
area = Pi * radius * radius;

#define PRT printf              // 함수명을 매크로 상수로 정의
PRT("hello");

#define UINT unsigned int       // 데이터형을 매크로 상수로 정의
UINT num;
```

## 3. 매크로 함수

1. 매크로 함수는 함수처럼 **인자를 갖는 매크로**
2. 매크로 상수처럼 매크로 함수가 사용되는 곳에 **문자열 대치**를 통해서 코드 확장
3. 매크로 함수는 함수인 것처럼 보이지만 함수가 아님
4. 컴파일 시에 인자의 데이터형 검사를 수행하지 않으며, 인자를 매개변수로 전달하는 **함수 호출 과정이 수행되지 않음**
5. 매크로 함수 사용 시 문자열 대치 과정에서 잘못된 결과가 만들어질 수도 있음

```c++
#define SQUARE(n) n * n
result = SQUARE(1+2)        // 1+2 * 1+2;로 문자열 대치됨
```

6. 매크로 함수를 사용하면 **프로그램의 실행 속도가 빨라짐**
    > 매크로 함수를 사용할 때는 함수 호출이 일어나지 않아 오버헤드를 줄일 수 있음

7. 매크로 함수를 많이 사용하는 프로그램은 **프로그램의 크기가 커짐**
    > 일반 함수 코드는 한 번만 컴파일해서 만들어두고 필요할 때 호출하지만, 매크로 함수는 사용되는 곳마다 복사됨

8. 매크로 함수를 사용하면 **코드가 알아보기 어려워짐**

## 4. 예약 매크로

|매크로|설명
|:--:|:--
|__DATE__|최근 컴파일 날짜
|__FILE__|소스 파일의 이름을 절대경로와 함께함
|__LINE__|소스 파일에 해당 문장이 있는 줄 번호
|__TIME__|최근 컴파일한 시각
|__TIMESTAMP__|소스 파일을 수정한 시각

## 5. 조건부 컴파일

### #if, #else, #endif

1. 특정 조건이 만족할 때만 컴파일
2. 상황에 따라서 특정 코드를 컴파일을 하거나 하지 않도록 만듦
3. 이식성 있는 코드를 개발할 때 유용
4. `#if`의 조건식에는 매크로를 관계 연산자, 산술 연산자, 논리 연산자 등이 사용됨
5. `#if`의 조건식에서 매크로를 실수나 문자열과 비교할 수 없음
6. `#if`에는 반드시 짝이 되는 `#endif`가 필요하며 `#else`, `#elif`를 함께 사용 가능
7. `#if`, `#endif`에서는 `{ }`로 묶어줄 필요가 없음
8. `#if` 안에 다른 `#if`를 중첩할 수 있고 각각의 `#if`마다 `#endif`가 짝을 이루어야 함

```c++

```

### #ifdef

1. "if defined"라는 의미
2. `#ifdef`는 특정 매크로의 정의 여부에 따라 `#ifdef`와 `#endif` 사이의 문장을 컴파일할지 결정

### #ifndef

1. "if not defined"라는 의미
2. `#ifndef` 다음의 매크로가 정의되지 않은 경우에만 `#ifndef`와 `#endif` 사이의 문장을 컴파일